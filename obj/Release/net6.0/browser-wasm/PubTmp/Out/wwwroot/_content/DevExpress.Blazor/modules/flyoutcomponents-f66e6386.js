import{a as t}from"./_tslib-bfc426b4.js";import{V as e,D as s,d as o,C as r,e as i,a,b as l}from"./popup-a7619af7.js";import{B as n}from"./popuproot-e4bfd720.js";import{P as h,N as c}from"./point-9c6ab88a.js";import{D as p}from"./popupbasedialog-4a39b856.js";import{S as d}from"./rect-2684652a.js";import{L as m}from"./layouthelper-c2462bd3.js";import{T as u}from"./transformhelper-3935ca6a.js";import{e as g,n as f}from"./property-0899c55e.js";import{s as b,r as w,$ as C}from"./lit-element-42a89b46.js";import{i as y}from"./query-8cb4c1ca.js";import{D as v,d as j}from"./events-interseptor-a82da75c.js";import"./rafaction-bba7928b.js";import"./positiontracker-9570b24e.js";import"./positiontrackerobserver-5fd93b2c.js";import"./elementobserver-5f004683.js";import"./supportcaptureelement-e000b699.js";import"./dx-ui-element-fa46d41b.js";import"./lit-element-base-cc37ea0b.js";import"./data-qa-utils-8be7c726.js";import"./branch-bb1eefec.js";import"./capturemanager-470a5b3f.js";import"./eventhelper-450cce9f.js";var S;var x;!function(t){t.top="top",t.right="right",t.bottom="bottom",t.left="left"}(x||(x={}));let P=S=class extends b{constructor(){super(...arguments),this.slotChangedHandler=this.handleSlotChanged.bind(this),this.arrow=null,this._alignment=x.bottom,this.position=e.zero,this.serverClass=null,this.clientClass=null,this.cssClass=null}get alignment(){return this._alignment}set alignment(t){const e=this._alignment;this._alignment=t,this.clientClass=this.calcClientCssClass(t),this.requestUpdate("alignment",e)}calcClientCssClass(t){return`bs-popover-${t}`}get arrowSize(){return this.arrow?S.calcSizeWithMargins(this.arrow,m.getRelativeElementRect(this.arrow).size):d.Empty}static calcSizeWithMargins(t,e){const s=window.getComputedStyle(t),o=parseFloat(s.marginLeft),r=parseFloat(s.marginRight),i=parseFloat(s.marginTop),a=parseFloat(s.marginBottom);return new d(e.width+o+r,e.height+i+a)}static get styles(){return w`
            :host {
                display: block;
            }
            ::slotted(.arrow) {
                top: 0;
                left: 0;
            }
        }`}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")){const t=[];this.clientClass&&this.clientClass.split(" ").forEach((e=>t.push(e))),this.serverClass&&this.serverClass.split(" ").forEach((e=>t.push(e))),this.cssClass=t.join(" ")}}updated(t){this.arrow&&t.has("position")&&(this.arrow.style.transform=u.translate(this.position.x,this.position.y)),t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return C`
            <slot @slotchange="${this.slotChangedHandler}"></slot>
        `}handleSlotChanged(t){const e=t.target.assignedNodes();for(const t in e){const s=e[t];if(s instanceof HTMLElement){this.arrow=s;break}}}};t([g({reflect:!1})],P.prototype,"position",void 0),t([g({type:String,attribute:"server-class"})],P.prototype,"serverClass",void 0),t([g({reflect:!1})],P.prototype,"clientClass",void 0),t([g({reflect:!1})],P.prototype,"cssClass",void 0),t([g({reflect:!1})],P.prototype,"alignment",null),P=S=t([f("dxbl-flyout-arrow")],P);let A=class extends p{constructor(){super(...arguments),this.arrowSlotChangeHandler=this.handleArrowSlotChange.bind(this),this._arrow=null,this._arrowAlignment=x.bottom,this.serverClass=null,this.clientClass=null,this.cssClass=null}get arrow(){return this._arrow}get arrowAlignment(){return this._arrowAlignment}set arrowAlignment(t){this._arrowAlignment=t,this.clientClass=this.calcClientCssClass(t)}calcClientCssClass(t){return`bs-popover-${t}`}willUpdate(t){if(t.has("serverClass")||t.has("clientClass")){const t=[];this.serverClass&&this.serverClass.split(" ").forEach((e=>t.push(e))),this.clientClass&&this.clientClass.split(" ").forEach((e=>t.push(e))),this.cssClass=t.join(" ")}}updated(t){t.has("cssClass")&&(this.className=this.cssClass?this.cssClass:"")}render(){return C`
            <slot></slot>
            <slot name="arrow" @slotchange="${this.arrowSlotChangeHandler}"></slot>
        `}handleArrowSlotChange(t){const e=t.target.assignedNodes();this._arrow=e[0]}};var B;t([g({type:String,attribute:"server-class"})],A.prototype,"serverClass",void 0),t([g({reflect:!1})],A.prototype,"clientClass",void 0),t([g({reflect:!1})],A.prototype,"cssClass",void 0),A=t([f("dxbl-flyout-dialog")],A),function(t){t.Auto="auto",t.LeftStart="leftstart",t.Left="left",t.LeftEnd="leftend",t.TopStart="topstart",t.Top="top",t.TopEnd="topend",t.RightStart="rightstart",t.Right="right",t.RightEnd="rightend",t.BottomStart="bottomstart",t.Bottom="bottom",t.BottomEnd="bottomend"}(B||(B={}));let R=class extends s{constructor(){super(),this.slotChangedHandler=this.handleSlotChange.bind(this),this.dialog=null,this.flyoutPlacement=B.Auto,this.placement=o.Custom}get branchType(){return n.DropDown}get child(){return this.root}processCustomPlacement(t,e){return this.calcCustomPlacements(t,e)}calcCustomPlacements(t,e){const s=[];switch(this.flyoutPlacement){case B.Bottom:s.push(this.calcBottomPlacement(t,e));break;case B.Top:s.push(this.calcTopPlacement(t,e));break;case B.Left:s.push(this.calcLeftPlacement(t,e));break;case B.Right:s.push(this.calcRightPlacement(t,e));break;case B.Auto:s.push(this.calcBottomPlacement(t,e)),s.push(this.calcTopPlacement(t,e)),s.push(this.calcLeftPlacement(t,e)),s.push(this.calcRightPlacement(t,e))}return s}calcBottomPlacement(t,e){const s=this.getBounds(e),o=this.getBounds(t);return new r(new h(s.width/2-o.width/2,s.height),i.Vertical,!1,a.Near,l.bottom)}calcTopPlacement(t,e){const s=this.getBounds(e),o=this.getBounds(t);return new r(new h(s.width/2-o.width/2,-o.height),i.Vertical,!1,a.Near,l.top)}calcLeftPlacement(t,e){const s=this.getBounds(e),o=this.getBounds(t);return new r(new h(-o.width,s.height/2-o.height/2),i.Horizontal,!1,a.Near,l.bottom)}calcRightPlacement(t,e){const s=this.getBounds(e),o=this.getBounds(t);return new r(new h(s.width,s.height/2-o.height/2),i.Horizontal,!1,a.Far,l.bottom)}renderTemplate(){return C`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${n.Flyout}">
                <dxbl-flyout-root
                    id="root"
                    style="${this.rootCssStyle}">
                    ${this.renderDefaultSlot()}
                    ${this.renderBridgeSlot()}
                </dxbl-flyout-root>
            </dxbl-branch>
        `}renderDefaultSlot(){return C`<slot @slotchange="${this.slotChangedHandler}"></slot>`}handleSlotChange(t){const e=t.target.assignedNodes();this.dialog=e.find((t=>t instanceof A)),this.reposition()}processBestTranslationResults(t,e,s,o,r,i,a){if(super.processBestTranslationResults(t,e,s,o,r,i,a),!this.dialog||!this.dialog.arrow)return;const l=this.calcArrowAlignment(r,i,a);this.dialog.arrowAlignment=l;const n=this.dialog.arrow,h=n.arrowSize,c=this.calcArrowPosition(h,t,e,s,r,i,a);n.position=this.validateArrowPosition(c,h,e,a),n.alignment=l}validateArrowPosition(t,s,o,r){return new e(c.toRange(t.x,r===i.Vertical?s.width:0,o.width-s.width),c.toRange(t.y,r===i.Horizontal?s.height:0,o.height-s.height))}calcArrowPosition(t,s,o,r,a,l,n){if(n===i.Horizontal){return new e(0,r.y+r.height/2-s.y-t.height/2)}if(n===i.Vertical){return new e(r.x+r.width/2-s.x-t.width/2,0)}return e.zero}calcArrowAlignment(t,e,s){return s===i.Vertical?e===l.bottom?x.bottom:x.top:t===a.Near?x.left:x.right}};t([y("#root",!0)],R.prototype,"root",void 0),t([g({type:String,attribute:"flyout-placement"})],R.prototype,"flyoutPlacement",void 0),R=t([f("dxbl-flyout")],R);let T=class extends b{constructor(){super(...arguments),this.dropOpposite=!1,this.dropDirection=a.Near,this.dropAlignment=l.bottom}static get styles(){return w`
            :host {
                display: flex;
                flex: 1 1 auto;
                flex-direction: column;
                align-items: stretch;
                justify-items: stretch;
                min-height: 0;
            }
        }`}render(){return C`
            <slot></slot>
            <slot name="arrow"/>
        `}};t([g({type:Object,attribute:"drop-opposite"})],T.prototype,"dropOpposite",void 0),t([g({type:String,attribute:"drop-direction"})],T.prototype,"dropDirection",void 0),t([g({type:String,attribute:"drop-alignment"})],T.prototype,"dropAlignment",void 0),T=t([f("dxbl-flyout-root")],T);function z(t){return t}const E={getReference:z,registeredComponents:["dxbl-flyout","dxbl-flyout-dialog","dxbl-flyout-root",v,j,"dxbl-flyout-arrow"]};export{E as default,z as getReference};
