import{a as e}from"./_tslib-bfc426b4.js";import{b as t}from"./dom-f057d094.js";import o from"./adaptivedropdowncomponents-b9273096.js";import{D as n}from"./dx-dropdown-editor-base-e7446c6d.js";import{ListBoxSelectedItemsChangedEvent as r}from"./dx-listbox-cede39ec.js";import{e as i}from"./property-0899c55e.js";import"./dropdowncomponents-586715ff.js";import"./popup-a7619af7.js";import"./rect-2684652a.js";import"./point-9c6ab88a.js";import"./rafaction-bba7928b.js";import"./transformhelper-3935ca6a.js";import"./layouthelper-c2462bd3.js";import"./positiontracker-9570b24e.js";import"./positiontrackerobserver-5fd93b2c.js";import"./elementobserver-5f004683.js";import"./supportcaptureelement-e000b699.js";import"./popuproot-e4bfd720.js";import"./branch-bb1eefec.js";import"./lit-element-42a89b46.js";import"./data-qa-utils-8be7c726.js";import"./capturemanager-470a5b3f.js";import"./eventhelper-450cce9f.js";import"./dx-ui-element-fa46d41b.js";import"./lit-element-base-cc37ea0b.js";import"./thumb-05a14c1b.js";import"./query-8cb4c1ca.js";import"./popupbasedialog-4a39b856.js";import"./events-interseptor-a82da75c.js";import"./modalcomponents-c2890212.js";import"./dx-ui-handlers-bridge-4076ae57.js";import"./dx-dropdown-owner-d9db7d72.js";var d;!function(e){e.ContentOrEditorWidth="contentoreditorwidth",e.ContentWidth="contentwidth",e.EditorWidth="editorwidth"}(d||(d={}));class s extends n{constructor(){super(),this.boundOnKeyUpHandler=this.onKeyUp.bind(this),this.boundOnInputTextChangedHandler=this.onInputTextChanged.bind(this),this.boundOnDropDownSelectedItemsChangedHandler=this.onDropDownSelectedItemsChanged.bind(this),this.dropDownWidthMode=d.ContentOrEditorWidth,this.filteringEnabled=!1,this.dropDownWidthSourceResizeObserver=new ResizeObserver(this.onDropDownWidthSourceSizeChanged.bind(this))}get useMobileFocusBehaviour(){return t.Browser.MobileUI||super.useMobileFocusBehaviour}connectedCallback(){super.connectedCallback(),this.observeForDropDownWidthSourceElementSize(),this.addEventListener("keyup",this.boundOnKeyUpHandler),this.addEventListener("input",this.boundOnInputTextChangedHandler)}disconnectedCallback(){this.dropDownWidthSourceResizeObserver.disconnect(),this.removeEventListener("input",this.boundOnInputTextChangedHandler),this.removeEventListener("keyup",this.boundOnKeyUpHandler),super.disconnectedCallback()}updated(e){super.updated(e),e.has("dropDownWidthMode")&&this.prepareDropDownWidth()}onSlotChanged(e){super.onSlotChanged(e);const t=this.getDropDownWidthSourceElement();this.dropDownWidthSourceResizeObserver.observe(t)}invokeKeyDownServerCommand(e){var t,o;if(!this.requireSendKeyCommandToServer(e))return super.invokeKeyDownServerCommand(e);const n={key:e.key,altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,inputText:null===(t=this.inputElement)||void 0===t?void 0:t.value};return null===(o=this.uiHandlersBridge)||void 0===o||o.send("invokeKeyDownCommand",n),!0}processLostFocus(){var e,t;const o={text:null===(e=this.inputElement)||void 0===e?void 0:e.value};null===(t=this.uiHandlersBridge)||void 0===t||t.send("lostFocus",o)}onKeyUp(e){var t;if("ArrowUp"===e.key||"ArrowDown"===e.key){const o={key:e.key};null===(t=this.uiHandlersBridge)||void 0===t||t.send("invokeKeyUpCommand",o)}}onInputTextChanged(e){var t;if(!this.filteringEnabled||!this.inputElement)return;e.stopPropagation();null===(t=this.uiHandlersBridge)||void 0===t||t.send("invokeFilterChangedCommand",{text:this.inputElement.value})}onDropDownSelectedItemsChanged(e){e.stopPropagation();const t=e.target;null==t||t.scrollToFocusedItem(!1)}onDropDownWidthSourceSizeChanged(e,t){if(e.length<1||!this.dropDownElement)return;const o=e[0].contentRect.width+"px";this.dropDownElement.desiredWidth=this.dropDownWidthMode===d.EditorWidth?o:null,this.dropDownElement.minDesiredWidth=this.dropDownWidthMode===d.ContentOrEditorWidth?o:null}ensureDropDownElement(){var e;super.ensureDropDownElement(),null===(e=this.dropDownElement)||void 0===e||e.addEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler)}disposeDropDownElement(){var e;null===(e=this.dropDownElement)||void 0===e||e.removeEventListener(r.eventName,this.boundOnDropDownSelectedItemsChangedHandler),super.disposeDropDownElement()}prepareDropDownWidth(){if(this.isInitialized)switch(this.dropDownWidthSourceResizeObserver.disconnect(),this.dropDownElement&&(this.dropDownElement.desiredWidth=null,this.dropDownElement.minDesiredWidth=null),this.dropDownWidthMode){case d.EditorWidth:case d.ContentOrEditorWidth:this.dropDownWidthSourceResizeObserver.observe(this.getDropDownWidthSourceElement())}}observeForDropDownWidthSourceElementSize(){this.dropDownWidthSourceResizeObserver.disconnect();const e=this.getDropDownWidthSourceElement();e&&this.dropDownWidthSourceResizeObserver.observe(e)}getDropDownWidthSourceElement(){return this.querySelector(".input-group")}requireSendKeyCommandToServer(e){switch(e.key){case"Enter":case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":return!0;case"Home":case"End":return e.ctrlKey||e.metaKey}return!1}}e([i({type:d,attribute:"dropdown-width-mode"})],s.prototype,"dropDownWidthMode",void 0),e([i({type:Boolean,attribute:"filtering-enabled"})],s.prototype,"filteringEnabled",void 0),customElements.define("dxbl-combobox",s);const p={loadModule:function(){},adaptiveDropdownComponents:o};export{s as DxComboBox,p as default};
